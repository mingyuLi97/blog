import{_ as s,o as a,c as e,a as n}from"./app.3de112f4.js";const u=JSON.parse('{"title":"JsBridge","description":"","frontmatter":{},"headers":[{"level":2,"title":"\u7528\u9014","slug":"\u7528\u9014","link":"#\u7528\u9014","children":[]},{"level":2,"title":"js \u8C03\u7528 Native","slug":"js-\u8C03\u7528-native","link":"#js-\u8C03\u7528-native","children":[{"level":3,"title":"\u65B9\u5F0F\u4E00\uFF1A\u62E6\u622A URL_SCHEME","slug":"\u65B9\u5F0F\u4E00\uFF1A\u62E6\u622A-url-scheme","link":"#\u65B9\u5F0F\u4E00\uFF1A\u62E6\u622A-url-scheme","children":[]},{"level":3,"title":"\u65B9\u5F0F\u4E8C\uFF1A\u6CE8\u5165 API","slug":"\u65B9\u5F0F\u4E8C\uFF1A\u6CE8\u5165-api","link":"#\u65B9\u5F0F\u4E8C\uFF1A\u6CE8\u5165-api","children":[]}]},{"level":2,"title":"Native \u8C03\u7528 js","slug":"native-\u8C03\u7528-js","link":"#native-\u8C03\u7528-js","children":[]},{"level":2,"title":"\u53C2\u8003","slug":"\u53C2\u8003","link":"#\u53C2\u8003","children":[]}],"relativePath":"knowledge/browser/jsBridge.md"}'),l={name:"knowledge/browser/jsBridge.md"},o=n(`<h1 id="jsbridge" tabindex="-1">JsBridge <a class="header-anchor" href="#jsbridge" aria-hidden="true">#</a></h1><h2 id="\u7528\u9014" tabindex="-1">\u7528\u9014 <a class="header-anchor" href="#\u7528\u9014" aria-hidden="true">#</a></h2><p>\u6784\u5EFA Native \u548C js \u4E4B\u95F4\u7684\u6D88\u606F\u901A\u9053\uFF0C\u5B9E\u73B0\u53CC\u5411\u901A\u4FE1\u3002</p><h2 id="js-\u8C03\u7528-native" tabindex="-1">js \u8C03\u7528 Native <a class="header-anchor" href="#js-\u8C03\u7528-native" aria-hidden="true">#</a></h2><h3 id="\u65B9\u5F0F\u4E00\uFF1A\u62E6\u622A-url-scheme" tabindex="-1">\u65B9\u5F0F\u4E00\uFF1A\u62E6\u622A URL_SCHEME <a class="header-anchor" href="#\u65B9\u5F0F\u4E00\uFF1A\u62E6\u622A-url-scheme" aria-hidden="true">#</a></h3><p><code>URL Scheme</code> \u662F\u7C7B URL \u7684\u4E00\u79CD\u8BF7\u6C42\u683C\u5F0F\uFF1A<code>&lt;protocol&gt;://&lt;host&gt;/&lt;path&gt;?&lt;query&gt;#fragment</code></p><p>\u4E00\u822C\u4F1A\u7EA6\u5B9A\u4E00\u79CD\u534F\u8BAE\u683C\u5F0F\uFF0C\u4F8B\uFF1A<code>weixin://dl/about</code></p><h5 id="\u5BA2\u6237\u7AEF\u62E6\u622A-web-\u53D1\u8D77\u7684\u8BF7\u6C42\uFF1A" tabindex="-1">\u5BA2\u6237\u7AEF\u62E6\u622A web \u53D1\u8D77\u7684\u8BF7\u6C42\uFF1A <a class="header-anchor" href="#\u5BA2\u6237\u7AEF\u62E6\u622A-web-\u53D1\u8D77\u7684\u8BF7\u6C42\uFF1A" aria-hidden="true">#</a></h5><ul><li>\u5982\u679C\u7B26\u5408\u6211\u4EEC\u81EA\u5B9A\u4E49\u7684 URL Schema\uFF0C\u5BF9 URL \u8FDB\u884C\u89E3\u6790\uFF0C\u62FF\u5230\u76F8\u5173\u64CD\u4F5C\u3001\u64CD\u4F5C\uFF0C\u8FDB\u800C\u8C03\u7528\u539F\u751F Native \u7684\u65B9\u6CD5</li><li>\u5982\u679C\u4E0D\u7B26\u5408\u6211\u4EEC\u81EA\u5B9A\u4E49\u7684 URL Schema\uFF0C\u6211\u4EEC\u76F4\u63A5\u8F6C\u53D1\uFF0C\u8BF7\u6C42\u771F\u6B63\u7684\u670D\u52A1</li></ul><h5 id="web-\u53D1\u9001-url-\u8BF7\u6C42\u7684\u65B9\u6CD5\uFF1A" tabindex="-1">Web \u53D1\u9001 URL \u8BF7\u6C42\u7684\u65B9\u6CD5\uFF1A <a class="header-anchor" href="#web-\u53D1\u9001-url-\u8BF7\u6C42\u7684\u65B9\u6CD5\uFF1A" aria-hidden="true">#</a></h5><ul><li><code>\u4F7F\u7528 iframe.src (\u5E38\u7528)</code></li><li>a \u6807\u7B7E (\u9700\u8981\u7528\u6237\u64CD\u4F5C)</li><li>location.href (\u80FD\u4F1A\u5F15\u8D77\u9875\u9762\u7684\u8DF3\u8F6C\u4E22\u5931\u8C03\u7528)</li><li>\u53D1\u9001 ajax \u8BF7\u6C42 (Android \u6CA1\u6709\u76F8\u5E94\u7684\u62E6\u622A\u65B9\u6CD5)</li></ul><h3 id="\u65B9\u5F0F\u4E8C\uFF1A\u6CE8\u5165-api" tabindex="-1">\u65B9\u5F0F\u4E8C\uFF1A\u6CE8\u5165 API <a class="header-anchor" href="#\u65B9\u5F0F\u4E8C\uFF1A\u6CE8\u5165-api" aria-hidden="true">#</a></h3><p>\u8FD9\u4E2A\u65B9\u6CD5\u4F1A\u901A\u8FC7 webView \u63D0\u4F9B\u7684\u63A5\u53E3\uFF0CApp \u5C06 Native \u7684\u76F8\u5173\u63A5\u53E3\u6CE8\u5165\u5230 JS \u7684 Context\uFF08window\uFF09\u7684\u5BF9\u8C61\u4E2D\uFF0C\u4E00\u822C\u6765\u8BF4\u8FD9\u4E2A\u5BF9\u8C61\u5185\u7684\u65B9\u6CD5\u540D\u4E0E Native \u76F8\u5173\u65B9\u6CD5\u540D\u662F\u76F8\u540C\u7684\uFF0CWeb \u7AEF\u5C31\u53EF\u4EE5\u76F4\u63A5\u5728\u5168\u5C40 window \u4E0B\u4F7F\u7528\u8FD9\u4E2A\u66B4\u9732\u7684\u5168\u5C40 JS \u5BF9\u8C61\uFF0C\u8FDB\u800C\u8C03\u7528\u539F\u751F\u7AEF\u7684\u65B9\u6CD5\u3002</p><div class="language-javascript"><button class="copy"></button><span class="lang">javascript</span><pre><code><span class="line"><span style="color:#E5C07B;">window</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">WeixinJSBridge</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">showDialog</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;hello&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span></code></pre></div><h5 id="\u5B9E\u73B0\u56DE\u8C03" tabindex="-1">\u5B9E\u73B0\u56DE\u8C03 <a class="header-anchor" href="#\u5B9E\u73B0\u56DE\u8C03" aria-hidden="true">#</a></h5><p>\u901A\u8FC7\u4E24\u6B21\u5355\u9879\u901A\u4FE1\u5B9E\u73B0\uFF1A\u4E00\u7AEF\u8C03\u7528\u7684\u65F6\u5019\u5728\u53C2\u6570\u4E2D\u52A0\u4E00\u4E2A callbackId \u6807\u8BB0\u5BF9\u5E94\u7684\u56DE\u8C03\uFF0C\u5BF9\u7AEF\u63A5\u6536\u5230\u8C03\u7528\u8BF7\u6C42\u540E\uFF0C\u8FDB\u884C\u5B9E\u9645\u64CD\u4F5C\uFF0C\u5982\u679C\u5E26\u6709 callbackId\uFF0C\u5BF9\u7AEF\u518D\u8FDB\u884C\u4E00\u6B21\u8C03\u7528\uFF0C\u5C06\u7ED3\u679C\u3001callbackId \u56DE\u4F20\u56DE\u6765\uFF0C\u8FD9\u7AEF\u6839\u636E callbackId \u5339\u914D\u76F8\u5E94\u7684\u56DE\u8C03\uFF0C\u5C06\u7ED3\u679C\u4F20\u5165\u6267\u884C\u5C31\u53EF\u4EE5\u4E86\u3002</p><h2 id="native-\u8C03\u7528-js" tabindex="-1">Native \u8C03\u7528 js <a class="header-anchor" href="#native-\u8C03\u7528-js" aria-hidden="true">#</a></h2><p>js \u662F\u89E3\u91CA\u578B\u8BED\u8A00\uFF0C\u5176\u7279\u70B9\u5C31\u662F\u80FD\u968F\u65F6\u968F\u5730\u6267\u884C\u4E00\u6BB5 js \u4EE3\u7801 \u3002 Android 4.4 \u4E4B\u524D\u53EA\u80FD\u7528 <code>loadUrl</code> \u6765\u5B9E\u73B0\uFF0C\u5E76\u4E14\u65E0\u6CD5\u6267\u884C\u56DE\u8C03\uFF1A</p><div class="language-java"><button class="copy"></button><span class="lang">java</span><pre><code><span class="line"><span style="color:#E5C07B;">String</span><span style="color:#E06C75;"> jsCode </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;window.showWebDialog(&#39;%s&#39;)&quot;</span><span style="color:#ABB2BF;">, text);</span></span>
<span class="line"><span style="color:#E5C07B;">webView</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">loadUrl</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;javascript: &quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> jsCode);</span></span>
<span class="line"></span></code></pre></div><p>Android 4.4 \u4E4B\u540E\u63D0\u4F9B\u4E86 <code>evaluateJavascript</code> \u6765\u6267\u884C JS \u4EE3\u7801\uFF0C\u5E76\u4E14\u53EF\u4EE5\u83B7\u53D6\u8FD4\u56DE\u503C\u6267\u884C\u56DE\u8C03\uFF1A</p><div class="language-java"><button class="copy"></button><span class="lang">java</span><pre><code><span class="line"><span style="color:#E5C07B;">String</span><span style="color:#E06C75;"> jsCode </span><span style="color:#56B6C2;">=</span><span style="color:#E06C75;"> </span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">format</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;window.showWebDialog(&#39;%s&#39;)&quot;</span><span style="color:#ABB2BF;">, text);</span></span>
<span class="line"><span style="color:#E5C07B;">webView</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">evaluateJavascript</span><span style="color:#ABB2BF;">(jsCode, </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">ValueCallback</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;">&gt;() {</span></span>
<span class="line"><span style="color:#ABB2BF;">@</span><span style="color:#E5C07B;">Override</span></span>
<span class="line"><span style="color:#C678DD;">public</span><span style="color:#61AFEF;"> </span><span style="color:#C678DD;">void</span><span style="color:#61AFEF;"> onReceiveValue</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">String</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">)</span><span style="color:#61AFEF;"> </span><span style="color:#ABB2BF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span></code></pre></div><p>iOS \u7684 UIWebView \u4F7F\u7528 <code>stringByEvaluatingJavaScriptFromString\uFF1A</code></p><div class="language-objective-c"><button class="copy"></button><span class="lang">objective-c</span><pre><code><span class="line"><span style="color:#E5C07B;">NSString</span><span style="color:#ABB2BF;"> _jsStr </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">@&quot;\u6267\u884C\u7684 JS \u4EE3\u7801&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">[webView </span><span style="color:#61AFEF;">stringByEvaluatingJavaScriptFromString:</span><span style="color:#ABB2BF;">jsStr];</span></span>
<span class="line"></span></code></pre></div><p>iOS \u7684 WKWebView \u4F7F\u7528 <code>evaluateJavaScript\uFF1A</code></p><div class="language-objective-c"><button class="copy"></button><span class="lang">objective-c</span><pre><code><span class="line"><span style="color:#ABB2BF;">[webView </span><span style="color:#61AFEF;">evaluateJavaScript:</span><span style="color:#98C379;">@&quot;\u6267\u884C\u7684 JS \u4EE3\u7801&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">completionHandler:</span><span style="color:#ABB2BF;">^(</span><span style="color:#C678DD;">id</span><span style="color:#ABB2BF;"> \\_Nullable response, </span><span style="color:#E5C07B;">NSError</span><span style="color:#ABB2BF;"> \\_ \\_Nullable error) {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">}];</span></span>
<span class="line"></span></code></pre></div><h2 id="\u53C2\u8003" tabindex="-1">\u53C2\u8003 <a class="header-anchor" href="#\u53C2\u8003" aria-hidden="true">#</a></h2><ul><li><a href="https://juejin.cn/post/6936814903021797389" target="_blank" rel="noreferrer">\u6398\u91D1\uFF1A\u6DF1\u5165\u6D45\u51FA JSBridge\uFF1A\u4ECE\u539F\u7406\u5230\u4F7F\u7528</a></li></ul>`,27),p=[o];function t(r,c,i,d,B,y){return a(),e("div",null,p)}const v=s(l,[["render",t]]);export{u as __pageData,v as default};
